<div class="message-top-wrapper">
  <div class="section center-align">
    <% @entries.each do |e| %>
      <% unless e.user == current_user %>
        <%= link_to(profile_path(e.user.profile)) do %>
          <% if e.user.profile.avatar? %>
            <%= image_tag e.user.profile.avatar.url, class: 'circle-small-img' %>
          <% else %>
            <%= image_tag 'icon_default.png', class: 'circle-small-img' %>
          <% end %>
          <strong><%= e.user.profile.username %></strong>
        <% end %>
      <% end %>
    <% end %> 
  </div>
  <div class="divider"></div>
</div>

<div class="messages-wrapper">
  <% @messages.each do |m| %>
    <% if m.user == current_user %>
      <div class="my-message-wrapper">
        <div class="my-message">
          <%= safe_join(m.message.split("\n"), tag(:br)) %>
        </div>
      </div>
    <% else %>
      <div class="friend-message-flex">
        <div class="friend-message-img">
          <% if m.user.profile.avatar? %>
            <%= image_tag m.user.profile.avatar.url, class: 'circle-small-img' %>
          <% else %>
            <%= image_tag 'icon_default.png', class: 'circle-small-img' %>
          <% end %>
        </div>
        <div class="friend-message-wrapper">
          <div class="friend-message">
            <%= safe_join(m.message.split("\n"), tag(:br)) %>
          </div>
        </div>
      </div>
    <% end %>
  <% end %>
</div>


<%= form_with model: @message, local: true, class: 'col s12' do |f| %>
  <div class="message-form-wrapper">
    <div class="input-field message-form-left">
      <i class="material-icons prefix">mode_edit</i>
      <%= f.text_area :message, class: 'materialize-textarea' %>
      <%= f.label :message, 'メッセージ内容を入力' %>
      <%= f.hidden_field :room_id, value: @room.id %>  
    </div>
    <div class="message-form-right">
      <%= button_tag type: 'submit', class: 'btn-floating btn-small teal profile-dm' do %>
        <i class="material-icons">send</i>
      <% end %>
    </div>
  </div>
<% end %>


