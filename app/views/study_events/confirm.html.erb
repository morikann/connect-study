<%= render 'shared/title', title: '確認画面' %>

<div class="step-wrapper">  
  <div class="stepbar-row">
    <ol class="stepbar">
      <li class="done"><span>1</span></li>
      <li class="done"><span>2</span></li>
      <li class="done"><span>3</span></li>
      <li class="done"><span>4</span></li>
    </ol>
  </div>
</div>

<div class="card-panel profile-card">
  <!-- 直接[/confirm]を打ち込まれた際の場合わけ -->
  <% if session[:study_event] && session[:location] %>

    <%= form_with url: confirm_url, local: true do |f| %>
      <table>
        <tbody>
          <tr>
            <th>勉強会名</th>
            <td><%= session[:study_event]['name'] %></td>
          </tr>
          <tr>
            <th>イメージ画像</th>
            <td><%= image_tag session[:image_url] || 'study_default.png', class: 'study-event-img' %></td>
          </tr>
          <tr>
            <th>公開範囲</th>
            <% if session[:study_event]['display_range'] == true %>
              <td>フォロワーのみに公開</td>
            <% else %>
              <td>全体に公開</td>
            <% end %>
          </tr>
          <tr>
            <th>場所</th>
            <td><%= session[:location]['name'] %></td>
          </tr>
          <tr>
            <th>開催日</th>
            <td><%= session[:study_event]['date'] %></td>
          </tr>
          <tr>
            <th>時間</th>
            <td><%= session[:study_event]['begin_time'] %> ~ <%= session[:study_event]['finish_time'] %></td>
          </tr>
          <tr>
            <th>参加者</th>
            <td>
              <% session[:event_user].reject(&:blank?).each do |profile_id| %>
                <%= image_tag Profile.find_by(id: profile_id.to_i).avatar.url, class: 'circle-small-img' %>
                <%= Profile.find_by(id: profile_id.to_i).username %>
                <br>
              <% end %>
            </td>
          </tr>
          <tr>
            <th>詳細</th>
            <td><%= safe_join(session[:study_event]['description'].split("\n"), tag(:br)) %></td>
          </tr>
        </tbody>
      </table>
      <div id="map"></div>
    
      <div class="center-align">
        <%= button_tag type: 'submit', name: :back, class: 'btn waves-effect waves-light back-btn-color' do %>
          戻る
          <i class="material-icons left">chevron_left</i>
        <% end %>

        <%= button_tag type: 'submit', class: 'btn waves-effect waves-light' do %>
          勉強会をつくる
        <% end %>
      </div>
    <% end %>
  <% else %>
    <div class="step-alert-message"><span class="essential">※</span>ステップ順に登録してください</div>
  <% end %>
</div>
